<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TalentLink - Find Your Dream Job</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/companies.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <a href="index.html" class="logo">TalentLink</a>
            <div class="nav-links" id="navLinks">
                <a href="#" class="active">Home</a>
                <a href="jobs.html">Jobs</a>
                <a href="#companies">Companies</a>
                <a href="my-applications.html" id="applicationsLink">Your Applications</a>
                <!-- Post a Job Button - Only visible to employers -->
                <!-- Post a Job Button - Only visible to employers -->
                <a href="post-job.html" class="btn btn-primary" id="postJobBtn" style="display: none; margin-left: 10px;">
                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">add</i>
                    Post a Job
                </a>
                <!-- Onboard Company Button - Only visible to superusers -->
                <button class="btn btn-secondary" id="onboardCompanyBtn" style="display: none; margin-left: 10px;">
                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">business</i>
                    Onboard Company
                </button>
                <!-- Auth State Container - Will be managed by auth.js -->
                <div id="authState">
                    <!-- Login/Signup Buttons (Shown when not logged in) -->
                    <div class="auth-buttons" id="authButtons">
                        <a href="login.html" class="btn btn-outline" id="loginLink">Login</a>
                        <a href="signup.html" class="btn btn-primary" id="registerLink">Sign Up</a>
                    </div>
                    
                    <!-- User Menu (Shown when logged in) -->
                    <div class="user-menu" id="userMenu" style="display: none;">
                        <div class="user-dropdown">
                            <button class="user-avatar" id="userAvatar">
                                <span class="material-icons">account_circle</span>
                                <span id="userInitials" class="user-initials"></span>
                            </button>
                            <div class="dropdown-content" id="dropdownMenu">
                                <div class="user-info">
                                    <div id="userName" class="user-name">Loading...</div>
                                    <div id="userEmail" class="user-email"></div>
                                </div>
                                <div class="dropdown-divider"></div>
                                <a href="profile.html"><i class="material-icons">person</i> My Profile</a>
                                <a href="my-jobs.html"><i class="material-icons">work</i> My Jobs</a>
                                <a href="settings.html"><i class="material-icons">settings</i> Settings</a>
                                <div class="dropdown-divider"></div>
                                <a href="#" id="logoutBtn"><i class="material-icons">logout</i> Logout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <button class="hamburger" id="hamburger">
                <span class="material-icons">menu</span>
            </button>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>Find Your Dream Job Today</h1>
                <p>Browse thousands of job listings and find the perfect match for your skills and experience.</p>
                
                <!-- Search Form -->
                <form id="searchForm" class="search-form">
                    <div class="search-input-group">
                        <span class="material-icons">work_outline</span>
                        <input type="text" id="searchInput" placeholder="Job title, keywords, or company">
                    </div>
                    <div class="search-input-group">
                        <span class="material-icons">location_on</span>
                        <input type="text" id="locationInput" placeholder="Location">
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span class="material-icons">search</span> Search Jobs
                    </button>
                </form>
                
                <div class="popular-searches">
                    <span>Popular Searches:</span>
                    <a href="#">Frontend Developer</a>
                    <a href="#">UX Designer</a>
                    <a href="#">Project Manager</a>
                    <a href="#">Data Scientist</a>
                </div>
            </div>
            <div class="hero-image">
                <img src="image s/hero-illustration.svg" alt="Job Search Illustration">
            </div>
        </div>
    </header>

    <!-- Featured Companies Section -->
    <section id="featuredCompanies" class="section">
        <div class="container">
            <div class="section-header">
                <h2>Featured Companies</h2>
                <p>Discover top companies hiring on TalentLink</p>
                <div class="filters" style="margin-top: 1.5rem;">
                    <div class="filter-group">
                        <label for="industryFilter">Industry:</label>
                        <select id="industryFilter" class="filter-select">
                            <option value="">All Industries</option>
                            <option value="Technology">Technology</option>
                            <option value="Finance">Finance</option>
                            <option value="Healthcare">Healthcare</option>
                            <option value="Education">Education</option>
                            <option value="Retail">Retail</option>
                            <option value="Manufacturing">Manufacturing</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="sizeFilter">Company Size:</label>
                        <select id="sizeFilter" class="filter-select">
                            <option value="">All Sizes</option>
                            <option value="1-10">1-10 employees</option>
                            <option value="11-50">11-50 employees</option>
                            <option value="51-200">51-200 employees</option>
                            <option value="201-500">201-500 employees</option>
                            <option value="501-1000">501-1,000 employees</option>
                            <option value="1001-5000">1,001-5,000 employees</option>
                            <option value="5001-10000">5,001-10,000 employees</option>
                            <option value="10001+">10,000+ employees</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="companies-list">
                <!-- Companies will be loaded here by JavaScript -->
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading companies...</p>
                </div>
            </div>
            
            <div class="pagination">
                <!-- Pagination will be added by JavaScript -->
            </div>
            
            <div class="view-all-companies" style="text-align: center; margin-top: 2rem;">
                <a href="#" class="btn btn-primary" id="viewAllCompanies">View All Companies</a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features section bg-light">
        <div class="container">
            <div class="section-header">
                <h2>Why Choose TalentLink?</h2>
                <p>We connect top talent with leading companies worldwide</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <span class="material-icons">search</span>
                    </div>
                    <h3>Smart Search</h3>
                    <p>Find jobs that match your skills and preferences with our advanced search technology.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <span class="material-icons">verified_user</span>
                    </div>
                    <h3>Verified Companies</h3>
                    <p>All companies are thoroughly vetted to ensure legitimate job opportunities.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <span class="material-icons">notifications</span>
                    </div>
                    <h3>Job Alerts</h3>
                    <p>Get notified when new jobs matching your criteria are posted.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <span class="material-icons">support_agent</span>
                    </div>
                    <h3>24/7 Support</h3>
                    <p>Our support team is always ready to assist you with any questions.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Call to Action -->
    <section class="cta section">
        <div class="container">
            <div class="cta-content">
                <h2>Ready to find your dream job?</h2>
                <p>Create a free account and start applying to jobs that match your skills and experience.</p>
                <a href="register.html" class="btn btn-primary btn-lg">Get Started</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-about">
                    <h3>TalentLink</h3>
                    <p>Connecting talent with opportunity. Find your dream job or the perfect candidate today.</p>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook"><span class="material-icons">facebook</span></a>
                        <a href="#" aria-label="Twitter"><span class="material-icons">twitter</span></a>
                        <a href="#" aria-label="LinkedIn"><span class="material-icons">linkedin</span></a>
                        <a href="#" aria-label="Instagram"><span class="material-icons">instagram</span></a>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h4>For Job Seekers</h4>
                    <a href="#">Browse Jobs</a>
                    <a href="#">Create Profile</a>
                    <a href="#">Job Alerts</a>
                    <a href="#">Career Advice</a>
                </div>
                
                <div class="footer-links">
                    <h4>For Employers</h4>
                    <a href="#">Post a Job</a>
                    <a href="#">Browse Candidates</a>
                    <a href="#">Pricing</a>
                    <a href="#">Recruitment Solutions</a>
                </div>
                
                <div class="footer-links">
                    <h4>Company</h4>
                    <a href="#">About Us</a>
                    <a href="#">Contact</a>
                    <a href="#">Careers</a>
                    <a href="#">Blog</a>
                </div>
                
                <div class="footer-newsletter">
                    <h4>Subscribe to Our Newsletter</h4>
                    <p>Get the latest job postings and career advice delivered to your inbox.</p>
                    <form class="newsletter-form">
                        <input type="email" placeholder="Your email address" required>
                        <button type="submit" class="btn btn-primary">Subscribe</button>
                    </form>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 TalentLink. All rights reserved.</p>
                <div class="footer-legal">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Service</a>
                    <a href="#">Cookie Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button id="backToTop" class="back-to-top" aria-label="Back to top">
        <span class="material-icons">arrow_upward</span>
    </button>

    <!-- Scripts -->
    <script src="js/api.js" type="module"></script>
    <script src="js/auth.js" type="module"></script>
    <script src="js/companies.js" type="module"></script>
    <script src="js/jobs.js" type="module"></script>
    <script src="js/main.js" type="module"></script>
    <script type="module">
        // Import the Jobs and Companies classes
        import { Jobs } from './js/jobs.js';
        import { Companies } from './js/companies.js';
        
        // Initialize modules when the page loads
        document.addEventListener('DOMContentLoaded', async function() {
            // Wait for auth to be initialized
            await window.TalentLink.auth.initialize();
            
            // Initialize the Companies module with auth state
            const companiesModule = new Companies();
            
            // Make it available globally for debugging
            window.companiesModule = companiesModule;
            
            // Initialize the Jobs module
            const jobsModule = new Jobs();
            
            // Make it available globally for debugging
            window.TalentLink = window.TalentLink || {};
            window.TalentLink.jobs = jobsModule;
            
            // Listen for storage events to update job listings when changes occur in other tabs
            if (typeof(Storage) !== 'undefined') {
                window.addEventListener('storage', function(event) {
                    if (event.key === 'jobListingsUpdated' && window.TalentLink.jobs) {
                        console.log('[Index] Job listings updated in another tab, refreshing...');
                        window.TalentLink.jobs.loadJobs();
                    }
                });
            }

            // Also listen for page visibility changes to refresh data when user returns to the tab
            document.addEventListener('visibilitychange', function() {
                if (!document.hidden && window.TalentLink.jobs) {
                    console.log('[Index] Page became visible, refreshing job listings...');
                    window.TalentLink.jobs.loadJobs();
                }
            });
            
            // Mobile menu toggle
            const hamburger = document.getElementById('hamburger');
            const navLinks = document.getElementById('navLinks');
            
            if (hamburger && navLinks) {
                hamburger.addEventListener('click', () => {
                    navLinks.classList.toggle('active');
                    hamburger.classList.toggle('active');
                });
            }
            
            // Add click handler for the search form
            const searchForm = document.getElementById('searchForm');
            if (searchForm) {
                searchForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const query = document.getElementById('searchInput')?.value || '';
                    const location = document.getElementById('locationInput')?.value || '';
                    
                    // Redirect to jobs page with search parameters
                    const params = new URLSearchParams();
                    if (query) params.append('q', query);
                    if (location) params.append('location', location);
                    
                    window.location.href = `/jobs.html?${params.toString()}`;
                });
            }
            
            // Add click handler for the hero search button
            const heroSearchBtn = document.querySelector('.hero .btn-primary');
            if (heroSearchBtn) {
                heroSearchBtn.addEventListener('click', function() {
                    const query = document.getElementById('searchInput')?.value || '';
                    const location = document.getElementById('locationInput')?.value || '';
                    
                    // Redirect to jobs page with search parameters
                    const params = new URLSearchParams();
                    if (query) params.append('q', query);
                    if (location) params.append('location', location);
                    
                    window.location.href = `/jobs.html?${params.toString()}`;
                });
            }
            
            // Update applications link text based on user type
            function updateApplicationsLink() {
                const applicationsLink = document.getElementById('applicationsLink');
                if (applicationsLink && window.TalentLink?.auth) {
                    const isEmployer = window.TalentLink.auth.isEmployer();
                    applicationsLink.textContent = isEmployer ? 'Applications' : 'My Applications';
                    applicationsLink.href = isEmployer ? 'all-applications.html' : 'my-applications.html';
                }
            }
            
            // Update UI when auth state changes
            function handleAuthStateChange() {
                updateApplicationsLink();
                // Re-initialize companies to update UI based on auth state
                if (window.companiesModule) {
                    window.companiesModule.loadCompanies();
                }
            }
            
            // Update on auth state change
            window.addEventListener('authStateChange', handleAuthStateChange);
            
            // Initial update
            setTimeout(handleAuthStateChange, 100);
        });
    </script>
</body>
</html>
